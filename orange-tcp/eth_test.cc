#include "eth.h"
#include "gtest/gtest.h"

namespace orange_tcp {
namespace {

TEST(Ethernet, Crc) {
  uint8_t data[] = {0x08, 0x00, 0x27, 0xf4, 0xcb, 0x94, 0x0a, 0x00,
    0x27, 0x00, 0x00, 0x00, 0x08, 0x06, 0x00, 0x01, 0x08,
    0x00, 0x06, 0x04, 0x00, 0x02, 0x0a, 0x00, 0x27, 0x00,
    0x00, 0x00, 0xc0, 0xa8, 0x63, 0x01, 0x08, 0x00, 0x27,
    0xf4, 0xcb, 0x94, 0xc0, 0xa8, 0x63, 0x64, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

  uint32_t crc = crc32(data, sizeof(data));

  printf("crc = 0x%04x\n", crc);
  EXPECT_EQ(crc, 0xa6cb0959);
}

}  // namespace
}  // namespace orange_tcp
